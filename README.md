# Hyperspectral Image Reconstruction using PCA & Residual U-Net

**Author:** Kazi Hafiz Md Asad    
**Dataset:** CZ_hsdb (31 spectral channels, 420‚Äì720¬†nm)  
**Citation:** Chakrabarti & Zickler, CVPR 2011

---

## üöÄ Project Overview
This repository demonstrates a complete pipeline for reconstructing hyperspectral images (HSI) using:

1. **Data Preprocessing:** Loading real-world HSI scenes from MATLAB (`.mat`) files, normalizing, and resizing to 512√ó512 px.  
2. **Dimensionality Reduction:** Applying global PCA to reduce the 31 spectral channels down to 3 principal components.  
3. **Patch Extraction:** Implementing a lazy PyTorch `Dataset` that randomly samples 32√ó32 patches in PCA space.  
4. **Model Architecture:** Training a residual U‚ÄëNet with spectral normalization to reconstruct PCA components.  
5. **Evaluation & Metrics:** Inverting PCA to measure reconstruction quality on PSNR, SSIM, and SAM.  
6. **Visualization:** Generating figures for spatial bands, spectral profiles, error maps, training curves, and aggregate spectra.



## üîß Configuration
All key parameters are defined in the `Config` class at the top of `hsi_reconstruction.py`:

| Parameter           | Description                                        | Default        |
|---------------------|----------------------------------------------------|----------------|
| `dataset_path`      | Path to CZ_hsdb folder                             | `data/`        |
| `num_images`        | Number of HSI scenes to load                       | 40             |
| `target_resolution` | Resize spatial dimensions (H√óW)                    | (512,¬†512)     |
| `patch_size`        | Spatial size of training patches                   | 32             |
| `num_patches`       | Patches per epoch                                  | 15,000         |
| `batch_size`        | Mini-batch size                                    | 8              |
| `num_epochs`        | Training epochs                                    | 10             |
| `learning_rate`     | AdamW learning rate                                | 1e-4           |
| `weight_decay`      | AdamW weight decay                                 | 1e-4           |
| `pca_components`    | Number of PCA spectral components                  | 3              |
| `bands_to_plot`     | Indices of bands for visualization                 | `[0, 10, 20, 30]` |





## üìà Results & Visualization
- **Spatial Bands:** Side-by-side original vs. reconstructed bands.  
- **Spectral Profiles:** Reflectance curves at selected pixels.  
- **Error Maps:** Absolute difference visualized with a heatmap.  
- **Training Curves:** Loss, PSNR, SSIM, and SAM vs. epoch.  
- **Aggregate Spectra:** Mean reflectance across evaluation patches.

Figures generated by the script are ideal for inclusion in research papers or presentations.


## üîç Evaluation Metrics
- **PSNR (Peak Signal‚Äëto‚ÄëNoise Ratio)** ‚Äì measures pixel-wise fidelity.  
- **SSIM (Structural Similarity Index)** ‚Äì evaluates structural similarity.  
- **SAM (Spectral Angle Mapper)** ‚Äì computes angular difference in spectral space.

All metrics are averaged over 100 random patches each epoch and displayed in-command line and saved as plots.



